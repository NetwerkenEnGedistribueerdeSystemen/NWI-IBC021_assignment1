\documentclass[12pt, a4paper]{article}

\usepackage{enumerate}
\usepackage{multicol}
\usepackage{listings}

\setlength\parskip{1em}
\setlength\parindent{0em}

\title{Assignment 1}

\author{Hendrik Werner s4549775}

\begin{document}
\maketitle

\section{} %1
\begin{enumerate}[a]
	\item %a
	\begin{multicols}{2}
		I found 2 network interfaces. One is the localhost (lo) and one is an ethernet interface (eth0).

		\begin{tabular}{c|c}
			Network Interface & IP4\\\hline
			eth0 & 10.0.2.15\\
			lo & 127.0.0.1\\
		\end{tabular}
	\end{multicols}

	\item %b
	\paragraph{ping}
	I began by capturing the traffic on eth0 and issued the command "ping ru.nl". I stopped the process after 4 pings.

	This resulted in a broad casted ARP request to ask who has IP 10.0.2.3. After this request was answered a DNS lookup for ru.nl was issued and the answer contained ru.nl's IP4 address to which a ICMP ping was sent and an answer received. This step was repeated until the process was stopped.

	Interleaved with that was another ARP request to ask who 10.0.2.2 was but I don't know why. This address wasn't used after that.

	I expected the DNS requests to be cached but they were not. For each new ping there was another DNS lookup. The rest is pretty obvious: A request is sent to the looked up IP and an answer received. Then this is repeated until the user stops the process.

	\paragraph{traceroute}
	Next I used "traceroute google.com". The first thing it did was request the A and AAAA records for google.com over DNS. It received the IPv4, and IPv6 addresses of Google. I don't know why the IPv6 address was requested. It was not used. Maybe it would have been used if google.com had not had an IPv4 address.

	Next traceroute began sending UDP packets with increasing TTL (time to live). Those requests exceeded theit TTL somewhere along the way to google.com and the corresponding node sent an error in the ICMP protocol back to traceroute. This allows it to be identified as a hop on the route.

	By repeatedly doing this Wireshark can identify the whole route to google.com.

	\paragraph{whois}
	As advised I ran "whois 128.119.245.12". Just like traceroute it began by requesting the A and AAAA records of whois.arin.net but proceeded to ignore the IPv6 address.

	It then sent a lot of TCP packets to this address and got a lot of responses. I was told that some of those TCP packets were actually the WHOIS protocol but NetKit did not identify it as such. It contained Wireshark 1.8.2 which is quite old.

	I found the first request that contained the requested IP (128.119.245.12) and clicked "follow TCP Stream".

	If you create a website you have to register it to someone. You have to provide the information you can retrieve with whois. Whois just requests the information from the database and displays it.
\end{enumerate}

\section{} %2
\begin{enumerate}[a]
	\item %a
	I used the filter "http and ip.src == 128.119.245.12" to filter out only HTTP request that originated from the server.

	\item %b
	HTTP stream:

	\begin{lstlisting}[
		breaklines=true
	]
GET /wireshark-labs/INTRO-wireshark-file1.html HTTP/1.1
Host: gaia.cs.umass.edu
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.76 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate, sdch
Accept-Language: en-US,en;q=0.8,de;q=0.6

HTTP/1.1 200 OK
Date: Thu, 02 Feb 2017 13:23:01 GMT
Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.1e-fips PHP/5.4.16 mod_perl/2.0.10 Perl/v5.16.3
Last-Modified: Thu, 02 Feb 2017 06:59:01 GMT
ETag: "51-54786b33397f0"
Accept-Ranges: bytes
Content-Length: 81
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

<html>
Congratulations!  You've downloaded the first Wireshark lab file!
</html>
	\end{lstlisting}
\end{enumerate}

\section{} %3
\begin{enumerate}[a]
	\item %a
	\item %b
	\item %c
\end{enumerate}

\section{} %4
\begin{enumerate}[a]
	\item %a
	\item %b
	\item %c
\end{enumerate}

\section{} %5
\begin{enumerate}[a]
	\item %a
	\item %b
	\item %c
\end{enumerate}

\end{document}
